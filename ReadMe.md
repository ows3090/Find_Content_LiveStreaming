## 소개

### 동영상

이미지를 연속적으로 보여주며 마치 움직이는 것처럼 보이는 것

이 때 보여주는 이미지를 프레임이라고 하며, 초당 몇 장의 이미지를 보여주는지를 프레임 수라고 하고 단위는 FPS(Frame Per Second) 사용

프레임이 높으면 높은 수준의 동영상, 용량이 커지는 단점 존재 => 코덱프로그램을 통해 압축

### 스트리밍

동영상 일반 다운로드면 전부 다운로드 될 때까지 재생하지 못하는데 스트리밍은 오디오, 동영상을 압축기술을 이용하여 여러 개로 쪼개서 전송

따라서 하드디스크에 저장하지 않고 다운과 동시에 재생 가능

스트리밍 서비스는 인터넷 속도가 가장 중요한 요소

일반 다운로드 경우 인터넷 환경이 좋지 않으면 다운 속도가 느려질 뿐이지만, 스트리밍은 동영상을 저장하는 것이 아닌 바로 실행이기 때문에 정상적인 서비스 제공하지 못한다.

- 스트리밍 서비스 종류
  1. 프로그레시브 다운로드
  2. RTSP/RTMP 스트리밍
  3. 적응적 HTTP 스트리밍

### YUV 포맷

RGB는 색 그대로를 전부 표현 : 자세하고 풍부한 색 표현이지만 그만큼 용량이 커짐

동영상을 RGB로 한다면 영상의 용량이 커지는 단점 존재 => YUV 포맷

빛의 삼원색을 표현하는 RGB와 달리 빛의 밝기를 나타내는 휘도(Y), 색상신호 2개(U,V)로 표현

YUV 색 공간은 인간의 눈의 인지 원리를 응용

### 서브샘플링

동영상을 크기를 줄이기 위해 YUV를 그대로 사용하기 보다는 압축하는 것이 효율이 높다

사람 눈은 휘도에 더 민감하기 때문에 샘플링에도 적용하여 압축한다.

=> Y성분을 CbCr보다 많이 할당하게 되면 감소한 데이터에 비해 시각적 차이는 거의 없게 된다.

샘플링은 Y Cb Cr의 비율에 따라서 4:4:4 4:2:2 4:2:0로 나뉘게 된다.

일반적으로 한 픽셀을 RGB로 1바이트씩 표현하게 되면 3바이트가 필요하게 된다.

용량이 크기 때문에 YUV 서브샘플링을 이용하여 압축할 수 있다.

4:2:0 비율에서 Y는 WxH 만큼 존재, U와 V는 WxH/4만큼 존재하여 총 (WxH)x3/2 바이트를 사용한다. 

---

## 알고리즘 소개
연속된 라이브 스트리밍은 영상의 용량이 큰 단점이 존재한다. 그래서 코덱(압축 프로그램)을 사용하여 압축을 하여 용량을 줄이는데 압축프로그램을 사용하면 열화현상으로 인해 데이터 손실이 발생할 수 있습니다.

따라서, 원본영상과 압축한 후 디코딩된 영상을 비교하기 위한 사전작업 알고리즘을 소개합니다.

연속된 라이브 스트리밍에서 동영상이 여러 개 포함되어 있기 때문에 특정 영상의 시작과 끝의 위치를 찾는 알고리즘

입력 : width, height, template_1 path, template_10 path, 컨텐츠를 찾고 싶은 동영상이 담긴 폴더

출력 : 폴더 내의 모든 동영상에서 시작, 끝 컨텐츠의 위치와 동영상의 길이


### 알고리즘 찾는 순서

1. template_1과 동영상의 각 프레임마다 차이를 구합니다. 

   - Y성분, UV성분 따로 차이를 구해 두 개의 배열로 차이값을 할당합니다.
   - start_yframe_diff , start_uvframe_diff

   

2. template_2와 동영상의 각 프레임마다 차이를 구합니다.

   - Y성분, UV성분 따로 차이를 구해 두 개의 배열로 차이값을 할당합니다.
   - end_yframe_diff, end_uvframe_diff

   

3. start_uvframe_diff에서 급격히 차이가 나는 구간을 찾습니다.

   - Y의 frame_diff로 구별하기에 template_1과 template_10이 비슷하여 UV값을 비교합니다.
   - 프레임과 template_1의 차이가 갑자기 커지는 부분이 동영상이 시작하는 위치일 가능성이 있습니다.
   - 따라서 start_uvsum을 두어 프레임과 template_1의 차이가 가장 커지는 위치를 찾습니다.

   

4. template_1와 프레임 차이가 가장 커지는 부분이 무조건적으로 프레임 시작은 아닐수 있습니다.

   - 동영상 진행 중에 완전히 다른 화면으로 갈 경우로 잘못된 판단을 할 수 있습니다.
   - 따라서 template_1와 프레임 차이가 start_uvsum보다 클 경우 startuvframe_diff값이 기존의 값보다 작은지 확인합니다. 
     ( startuvframe_diff가 작다는 뜻은 template_1와 비슷한 프레임)

   

5. template_10과도 비슷하게 (3~4번)의 과정을 진행합니다.

   

6. 하지만 template_1과 template_10이 유사하여 똑같은 위치에서 start_uvframe_diff와 end_uvframe_diff가 급격히 차이날 수 있습니다.

   - 이럴경우 시작 위치과 끝 위치를 똑같은 결과가 나와 잘못된 값을 구합니다.
   - 따라서 급격히 차이난 정도를 비교하여 template_1과 template_10중에 더 급격히 차이난 부분만 확인합니다.











